!function t(i,e,s){function h(r,n){if(!e[r]){if(!i[r]){var o="function"==typeof require&&require;if(!n&&o)return o(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=e[r]={exports:{}};i[r][0].call(l.exports,function(t){var e=i[r][1][t];return h(e?e:t)},l,l.exports,t,i,e,s)}return e[r].exports}for(var a="function"==typeof require&&require,r=0;r<s.length;r++)h(s[r]);return h}({1:[function(t,i,e){"use strict";var s=Object.defineProperties,h=function(){function t(t,i,e,s,h,a,r,n){this.cx=h,this.coords={x:t,y:i},this.width=e,this.height=s,this.canvasHeight=a,this.canvasWidth=r,this.pitch=n,this.count=2}return s(t.prototype,{updateRatio:{value:function(t){if(this.canvasHeight<t.height&&this.canvasHeight<t.width||this.canvasWidth<t.width&&this.width){var i=t.width*t.height/(this.canvasWidth*this.canvasHeight);this.width=this.width/i,this.height=this.height/i}},enumerable:!1,writable:!0},update:{value:function(){},enumerable:!1,writable:!0},move:{value:function(t){this.maxValueX||(this.maxValueX=Math.max(window.innerHeight,window.innerWidth)-10-Math.min(this.height,this.width)),this.maxValueY||(this.maxValueY=Math.max(window.screen.height,window.screen.width)-10-Math.min(this.height,this.width)),this._height=this.height,this._width=this.width,"x"===t?(this.coords.x=this.coords.y,"left"===this.pitch?this.coords.y=70:this.coords.y=this.maxValueX-70,this.width<this.height&&(this.height=this._width,this.width=this._height)):(this.coords.y=this.coords.x,"left"===this.pitch?this.coords.x=70:this.coords.x=this.maxValueY-70,this.width>this.height&&(this.height=this._width,this.width=this._height))},enumerable:!1,writable:!0},draw:{value:function(){if("right"===this.pitch){this.cx.save(),this.cx.beginPath(),this.cx.fillStyle="#ffff00",this.el=this.cx.fillRect(this.coords.x,this.coords.y,this.width,this.height);var t=new Image;t.src="../images/guy.png",this.cx.drawImage(t,this.coords.x,this.coords.y,90,80),this.cx.closePath(),this.cx.restore()}else{this.cx.save(),this.cx.beginPath(),this.cx.fillStyle="#ffff00",this.el=this.cx.fillRect(this.coords.x,this.coords.y,this.width,this.height);var t=new Image;t.src="../images/guy-rotate.png",this.cx.drawImage(t,this.coords.x,this.coords.y-70,90,80),this.cx.closePath(),this.cx.restore()}},enumerable:!1,writable:!0}}),t}();e.Actor=h},{}],2:[function(t,i,e){"use strict";var s=Object.defineProperties,h=function(){function t(t,i,e,s,h,a){this.cx=e,this.x=t,this.y=i,this.space={top:0,right:s,bottom:h,left:0},this.dirX=1,this.dirY=1,this.boundaryY="bottom",this.boundaryX="right",this.pitch=a}return s(t.prototype,{draw:{value:function(){this.invisible||(this.cx.save(),this.cx.beginPath(),this.cx.fillStyle=this.fillStyle,this.cx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),this.cx.fill(),this.cx.closePath(),this.cx.restore())},enumerable:!1,writable:!0},reset:{value:function(t,i){this.x=t/2,this.y=i/2},enumerable:!1,writable:!0},coming:{value:function(t){if("y"===this.dirPlayer&&"y"===t.dirPlayer){var i=this.space.bottom/t.axis;this.y=t.y*i,"left"===this.pitch?(this.x=this.space.right-2*this.radius,this.dirX=-1):(this.x=2*this.radius,this.dirX=1)}else if("x"===this.dirPlayer&&"x"===t.dirPlayer){var i=this.space.right/t.axis;this.x=t.x*i,"left"===this.pitch?(this.y=this.space.bottom-2*this.radius,this.dirY=-1):(this.y=2*this.radius,this.dirY=1)}else if("y"===this.dirPlayer&&"x"===t.dirPlayer){var i=this.space.bottom/t.axis;this.y=t.x*i,"left"===this.pitch?(this.x=this.space.right-2*this.radius,this.dirX=-1):(this.x=2*this.radius,this.dirX=1)}else if("x"===this.dirPlayer&&"y"===t.dirPlayer){var i=this.space.right/t.axis;this.x=t.y*i,"left"===this.pitch?(this.y=this.space.bottom-2*this.radius,this.dirY=-1):(this.y=2*this.radius,this.dirY=1)}this.invisible=!1},enumerable:!1,writable:!0},update:{value:function(t){this.comingBall?this.comingBall=!1:this.x+this.radius>=this.space[this.boundaryX]||"collisionX"===t.collision||this.x<=this.radius?(t.collision&&(this.x=t.actorCoords),this.dirX*=-1):(this.y+this.radius>=this.space[this.boundaryY]||"collisionY"===t.collision||this.y<=this.radius)&&(t.collision&&(this.y=t.actorCoords),this.dirY*=-1),this.x+=this.x_speed*this.dirX,this.y+=this.y_speed*this.dirY},enumerable:!1,writable:!0},updateOnResize:{value:function(t,i){this.space={top:0,right:t,bottom:i,left:0},this._x=this.x,this._y=this.y,this.x=this._y,this.y=this._x,this._dirX=this.dirY,this._dirY=this.dirX,this.dirX=this._dirX,this.dirY=this._dirY},enumerable:!1,writable:!0}}),t}();e.Ball=h},{}],3:[function(t,i,e){"use strict";var s=Object.defineProperties,h=null,a=document,r=function(){function t(t){h=t,this._socketReady=!1,this.handleEvents(),this.setupSocket()}return s(t.prototype,{hide:{value:function(){a.querySelector(".lobby").classList.add("hidden")},enumerable:!1,writable:!0},handleEvents:{value:function(){a.querySelector(".choice-screen .btn.join").addEventListener("click",this.onJoinChoice.bind(this)),a.querySelector(".choice-screen .btn.create").addEventListener("click",this.onCreateChoice.bind(this)),a.querySelector(".join-screen .join-btn").addEventListener("click",this.onTokenSend.bind(this))},enumerable:!1,writable:!0},setupSocket:{value:function(){h.on("game:player-connected",this.onPlayerConnected.bind(this)),h.on("game:token-created",this.onTokenCreated.bind(this)),h.on("game:error",this.onGameError.bind(this))},enumerable:!1,writable:!0},onPlayerConnected:{value:function(){this._socketReady=!0},enumerable:!1,writable:!0},onJoinChoice:{value:function(){this._socketReady&&(a.querySelector(".join-screen").classList.add("onscreen"),a.querySelector(".choice-screen").classList.add("hidden"),sessionStorage.setItem("player","right"))},enumerable:!1,writable:!0},onCreateChoice:{value:function(){if(this._socketReady){sessionStorage.setItem("player","left"),a.querySelector(".choice-screen").classList.add("hidden");var t={height:window.innerHeight,width:window.innerWidth};h.emit("player:create-session",t)}},enumerable:!1,writable:!0},onTokenCreated:{value:function(t){a.querySelector(".create-screen .token").textContent=t.token,a.querySelector(".create-screen").classList.add("onscreen")},enumerable:!1,writable:!0},onTokenSend:{value:function(){var t={height:window.innerHeight,width:window.innerWidth};h.emit("player:joining",{token:a.querySelector(".join-screen input").value.toUpperCase(),canvasOpponent:t})},enumerable:!1,writable:!0},onGameError:{value:function(t){var i=a.querySelector(".notifier");i.classList.contains("visible")||(i.textContent=t.message,i.classList.add("visible"),setTimeout(function(){i.classList.remove("visible")},2500))},enumerable:!1,writable:!0}}),t}();e.Lobby=r},{}],4:[function(t,i,e){"use strict";function s(t,i,e){var i=i.split(" ");i.forEach(function(i){t.addEventListener(i,e)})}var h=Object.defineProperties,a=t("../elements/ball"),r=t("../elements/actor"),n=window,o=document,l=l||null,c=c||null,d=null,u=function(){function t(t,i){return t||i?(c=t,l=i,this.pitch=sessionStorage.getItem("player"),this.actor=new r.Actor(10,10,15,90,l,l.canvas.height,l.canvas.width,this.pitch),this.ball=new a.Ball(300,300,l,n.innerWidth,n.innerHeight,this.pitch),this.config(),c.on("message",this.socketListener),c.on("game:opponent-canvas",this.actor.updateRatio.bind(this.actor)),c.on("pong:goal-scored",this.goalHandler.bind(this)),c.on("pong:player-left",this.playerLeft.bind(this)),c.on("pong:ball-coming",this.ballComingHandler.bind(this)),this.scribbles={actors:this.actor,ball:this.ball},this.ball.invisible?(this.update(),this.touchListener()):(d=this.istance=this.init.bind(this),n.addEventListener("touchstart",d,!0)),void this.updateOnResize(!0)):void console.error("No io and/or ctx passed.")}return h(t.prototype,{init:{value:function(){this.update(),n.removeEventListener("touchstart",d,!0),this.touchListener()},enumerable:!1,writable:!0},playerLeft:{value:function(t){var i=o.createElement("div");i.className="notifier visible",i.textContent=t,o.body.appendChild(i),this.ball.invisible=!0},enumerable:!1,writable:!0},config:{value:function(){this.ball.fillStyle="#3a0b5b",this.actor.fillStyle="#ffff00",this.actor.halfHeight=this.actor.height/2,this.actor.halfWidth=this.actor.width/2,this.resetTime=500,this.ball.x_speed=10,this.ball.y_speed=10,this.ball.radius=10,"right"===this.pitch?this.ball.invisible=!1:this.ball.invisible=!0},enumerable:!1,writable:!0},waitForFinalEvent:{value:function(){var t={};return function(i,e,s){s||(s="Don't call this twice without a uniqueId"),t[s]&&clearTimeout(t[s]),t[s]=setTimeout(i.bind(this),e)}.apply(this,arguments)},enumerable:!1,writable:!0},orientation:{value:function(){n.addEventListener("resize",function(){this.waitForFinalEvent(this.updateOnResize,100,"some unique string")}.bind(this))},enumerable:!1,writable:!0},updateOnResize:{value:function(t){l.canvas.width=n.innerWidth,l.canvas.height=n.innerHeight,this.ball.updateOnResize(l.canvas.width,l.canvas.height),l.canvas.height>l.canvas.width?this.dirPlayer="x":this.dirPlayer="y",t&&this.orientation(),this.actor.move(this.dirPlayer),this.ball.dirPlayer=this.dirPlayer},enumerable:!1,writable:!0},draw:{value:function(){l.clearRect(0,0,l.canvas.width,l.canvas.height),this._draw()},enumerable:!1,writable:!0},_draw:{value:function(){this.scribbles.actors.draw(),this.scribbles.ball.draw(),requestAnimationFrame(this.draw.bind(this))},enumerable:!1,writable:!0},touchListener:{value:function(){s(n,"touchstart touchmove",function(t){t.preventDefault(),t.stopPropagation(),this.touchY=t.touches[0].pageY,this.touchX=t.touches[0].pageX,"x"===this.dirPlayer?(this.coordMove="pageX",this.touchX>=l.canvas.width-this.actor.halfHeight?this.actor.coords.x=l.canvas.width-this.actor.width:this.touchX<this.actor.halfHeight?this.actor.coords.x=0:this.actor.coords[this.dirPlayer]=t.touches[0][this.coordMove]-this.actor.halfHeight):(this.coordMove="pageY",this.touchY>=l.canvas.height-this.actor.halfHeight?this.actor.coords.y=l.canvas.height-this.actor.height:this.touchY<this.actor.halfHeight?this.actor.coords.y=0:this.actor.coords[this.dirPlayer]=t.touches[0][this.coordMove]-this.actor.halfHeight)}.bind(this))},enumerable:!1,writable:!0},goal:{value:function(){this.loseUpdate(),c.emit("pong:goal")},enumerable:!1,writable:!0},goalHandler:{value:function(){this.winUpdate()},enumerable:!1,writable:!0},loseUpdate:{value:function(){o.querySelector(".lose").classList.remove("hidden"),this.ball.reset(l.canvas.width,l.canvas.height),o.querySelector(".cancel").addEventListener("touchstart",function(t){o.querySelector(".lose").classList.add("hidden").bind(this)})},enumerable:!1,writable:!0},winUpdate:{value:function(){o.querySelector(".win").classList.remove("hidden"),this.ball.reset(l.canvas.width,l.canvas.height),o.querySelector(".cancel").addEventListener("touchstart",function(t){o.querySelector(".win").classList.add("hidden").bind(this)})},enumerable:!1,writable:!0},update:{value:function(){"y"===this.dirPlayer&&"left"===this.pitch?this.ball.x-this.ball.radius<=0?(this.goal(),this._update.call(this,this.resetTime)):this.ball.x+this.ball.radius>=l.canvas.width?(this.ball.comingBall=!0,this.ballComing(l.canvas.height)):this._update():"y"===this.dirPlayer&&"right"===this.pitch?this.ball.x+this.ball.radius>=l.canvas.width?(this.goal(),this._update.call(this,this.resetTime)):this.ball.x-this.ball.radius<=0?(this.ball.comingBall=!0,this.ballComing(l.canvas.height)):this._update():"x"===this.dirPlayer&&"left"===this.pitch?this.ball.y-this.ball.radius<=0?(this.goal(),this._update.call(this,this.resetTime)):this.ball.y+this.ball.radius>=l.canvas.height?(this.ball.comingBall=!0,this.ballComing(l.canvas.width)):this._update():"x"===this.dirPlayer&&"right"===this.pitch&&(this.ball.y+this.ball.radius>=l.canvas.height?(this.goal(),this._update.call(this,this.resetTime)):this.ball.y-this.ball.radius<=0?(this.ball.comingBall=!0,this.ballComing(l.canvas.width)):this._update())},enumerable:!1,writable:!0},_update:{value:function(t){var i=this.checkCollision(this.dirPlayer);for(var e in this.scribbles)this.scribbles[e].update(i);this.ball.invisible||(t?(cancelAnimationFrame(this.requestId),this.requestId=void 0,setTimeout(this.update.bind(this),t)):this.requestId=requestAnimationFrame(this.update.bind(this)))},enumerable:!1,writable:!0},ballComing:{value:function(t){var i={type:"ballComing",axis:t,x:this.ball.x,y:this.ball.y,dirPlayer:this.dirPlayer,canvas:{width:l.canvas.width,height:l.canvas.height,ratio:l.canvas.ratio}};this.ball.invisible=!0,c.emit("pong:ball-info",i)},enumerable:!1,writable:!0},ballComingHandler:{value:function(t){var i=this.ball.coming(t);i||this.update(!0)},enumerable:!1,writable:!0},checkCollision:{value:function(t){return"y"===t&&"left"===this.pitch?this.ball.x-this.ball.radius<this.actor.coords.x+this.actor.width&&this.ball.y>=this.actor.coords.y&&this.ball.y<=this.actor.height+this.actor.coords.y&&{collision:"collisionX",actorCoords:this.actor.coords.x+this.actor.width}:"y"===t&&"right"===this.pitch?this.ball.x+this.ball.radius>this.actor.coords.x&&this.ball.y>=this.actor.coords.y&&this.ball.y<=this.actor.height+this.actor.coords.y&&{collision:"collisionX",actorCoords:this.actor.coords.x-this.ball.radius}:"x"===t&&"left"===this.pitch?this.ball.y-this.ball.radius<this.actor.coords.y+this.actor.height&&this.ball.x>=this.actor.coords.x&&this.ball.x<=this.actor.width+this.actor.coords.x&&{collision:"collisionY",actorCoords:this.actor.coords.y+this.actor.height+this.ball.radius}:"x"===t&&"right"===this.pitch?this.ball.y+this.ball.radius>this.actor.coords.y&&this.ball.x>=this.actor.coords.x&&this.ball.x<=this.actor.width+this.actor.coords.x&&{collision:"collisionY",actorCoords:this.actor.coords.y-this.ball.radius}:void 0},enumerable:!1,writable:!0}}),t}();e.Pong=u},{"../elements/actor":1,"../elements/ball":2}],5:[function(t,i,e){"use strict";var s=t("../elements/pong").Pong,h=t("../elements/lobby").Lobby;window.onload=function(){var t,i=io(),e=document.querySelector("canvas"),a=new h(i);i.on("game:ready",function(){a.hide(),t=e.getContext("2d"),e.width=Math.max(window.innerWidth,window.innerHeight),e.height=Math.min(window.innerWidth,window.innerHeight);var h=new s(i,t);h.draw()})}},{"../elements/lobby":3,"../elements/pong":4}]},{},[5]);